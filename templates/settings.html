{% extends "base.html" %}
{% block title %}Settings | NOVUS{% endblock %}
{% block content %}
<div class="container py-3 settings-page">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h2 class="mb-0">Settings</h2>
      <p class="text-muted mb-0">Manage your account and preferences</p>
    </div>
  </div>

  <div class="row g-4">
    <!-- Settings Content -->
    <div class="col-12">
      <!-- Account Settings -->
      <div class="section-container mb-4">
        <div class="section-title">
          <i class="fas fa-user me-2"></i>Account Settings
        </div>
        <form method="post" action="{{ url_for('settings') }}">
          <input type="hidden" name="action" value="update_account">
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Username</label>
              <input type="text" class="form-control" name="username" value="{{ user[0] }}" required>
            </div>
            <div class="col-md-6">
              <label class="form-label">Email</label>
              <input type="email" class="form-control" name="email" value="{{ user[1] or '' }}">
            </div>
          </div>
          <button type="submit" class="btn btn-neon mt-3">
            <i class="fas fa-save me-2"></i>Update Account
          </button>
        </form>
      </div>

      <!-- Security Settings -->
      <div class="section-container mb-4">
        <div class="section-title">
          <i class="fas fa-shield me-2"></i>Security
        </div>
        <form method="post" action="{{ url_for('settings') }}">
          <input type="hidden" name="action" value="change_password">
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Current Password</label>
              <input type="password" class="form-control" name="current_password" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">New Password</label>
              <input type="password" class="form-control" name="new_password" required>
            </div>
            <div class="col-md-4">
              <label class="form-label">Confirm New Password</label>
              <input type="password" class="form-control" name="confirm_password" required>
            </div>
          </div>
          <button type="submit" class="btn btn-neon mt-3">
            <i class="fas fa-key me-2"></i>Change Password
          </button>
        </form>
      </div>

      <!-- Appearance Settings -->
      <div class="section-container">
        <div class="section-title">
          <i class="fas fa-palette me-2"></i>Appearance
        </div>
        <p class="text-muted mb-3">Customize your reading experience and interface preferences.</p>
        <button type="button" class="btn btn-outline-light" data-action="openAppearanceModal">
          <i class="fas fa-cog me-2"></i>Open Appearance Settings
        </button>
      </div>
    </div>
  </div>
</div>

<script>
// Global centralized event handler for settings page
document.addEventListener('click', function(e) {
  const element = e.target.closest('[data-action]');
  if (!element) return;
  
  const action = element.dataset.action;
  
  switch (action) {
    case 'openAppearanceModal':
      if (window.openAppearanceModal) {
        window.openAppearanceModal();
      }
      break;
  }
});
</script>
{% endblock %}